<!-- sign-up.html -->
<script type="module">
  import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB-BKp6RXc93xPSQh9bO4MbGAuJTjA3EuM",
    authDomain: "notify-21996.firebaseapp.com",
    projectId: "notify-21996",
    storageBucket: "notify-21996.firebasestorage.app",
    messagingSenderId: "502972762939",
    appId: "1:502972762939:web:748f6604b3d6c4b543c51e",
    measurementId: "G-S475SM2XQW"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  document.getElementById('signup-form').addEventListener('submit', function (e) {
    e.preventDefault();

    let name = document.getElementById('name').value;
    let email = document.getElementById('email').value;
    let password = document.getElementById('password').value;
    let confirmPassword = document.getElementById('confirm-password').value;

    const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
    if (!emailRegex.test(email)) {
        alert("Please enter a valid email address.");
        return;
    }

    if (password !== confirmPassword) {
        alert("Passwords do not match.");
        return;
    }

    // Create user with Firebase Authentication
    createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // User created successfully
        const user = userCredential.user;

        // Save user data to Firestore (Firestore Database)
        addDoc(collection(db, "users"), {
          name: name,
          email: email,
          userId: user.uid
        });

        alert("Sign Up successful!");
        window.location.href = "sign-in.html"; // Redirect to sign-in page
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;
        alert("Error: " + errorMessage);
      });
  });
</script>
